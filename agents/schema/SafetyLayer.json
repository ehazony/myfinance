{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "SafetyLayer",
    "type": "object",
    "required": ["safety_id","snapshot_id","emergency_months_required","emergency_months_current","insurance_coverages"],
    "properties": {
      "safety_id":  {"type":"string","format":"uuid"},
      "snapshot_id":{"type":"string","format":"uuid"},
  
      "emergency_months_required":{"type":"number"},
      "emergency_months_current": {"type":"number"},
      "protection_score":{"type":"number","minimum":0,"maximum":100},
  
      "insurance_coverages":{
        "type":"array",
        "items":{"$ref":"InsuranceCoverage"}
      },
      "estate_documents":{
        "type":"array",
        "items":{"$ref":"EstateDoc"}
      }
    },
  
    "definitions":{
      "InsuranceCoverage":{
        "type":"object",
        "required":["policy_id","coverage_type","coverage_amount","premium","status"],
        "properties":{
          "policy_id":{"type":"string","format":"uuid"},
          "coverage_type":{"type":"string","enum":["health","life","disability","home","car","other"]},
          "coverage_amount":{"type":"number"},
          "premium":{"type":"number"},
          "deductible":{"type":"number"},
          "status":{"type":"string","enum":["active","lapsed","pending"]},
          "provider":{"type":"string"}
        }
      },
      "EstateDoc":{
        "type":"object",
        "required":["doc_type","status"],
        "properties":{
          "doc_type":{"type":"string","enum":["will","power_of_attorney","beneficiary_designation"]},
          "status":{"type":"string","enum":["completed","missing","outdated"]},
          "last_updated":{"type":"string","format":"date"}
        }
      }
    }
  }